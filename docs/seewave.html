<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>OTS Bioacoustic Analysis in R 2023 - Seewave</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">OTS Bioacoustic Analysis in R 2023</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./program.html">
 <span class="menu-text">Program</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-tutorials" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Tutorials</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-tutorials">    
        <li>
    <a class="dropdown-item" href="./introduction.html">
 <span class="dropdown-text">Introduction</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./r_basics.html">
 <span class="dropdown-text">R basics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sound.html">
 <span class="dropdown-text">Sound</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./spectrograms.html">
 <span class="dropdown-text">Spectrograms</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./seewave.html">
 <span class="dropdown-text">seewave</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./annotations.html">
 <span class="dropdown-text">Annotations</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./ohun.html">
 <span class="dropdown-text">ohun: automatic detection</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./intro_to_warbler.html">
 <span class="dropdown-text">Intro to warbleR</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./measure_acoustic_structure.html">
 <span class="dropdown-text">Measure acoustic structure</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./comparing_methods.html">
 <span class="dropdown-text">Comparing measuring methods</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./quality_checks.html">
 <span class="dropdown-text">Quality checks</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./measure_structure_green_hermit.html">
 <span class="dropdown-text">Measure structure on XC recordings</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./course_prep.html">
 <span class="menu-text">Course prep</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./instructor.html">
 <span class="menu-text">Instructor</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/maRce10/OTS_BIR_2023/"><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul class="collapse">
  <li><a href="#oscillograms" id="toc-oscillograms" class="nav-link active" data-scroll-target="#oscillograms"><span class="toc-section-number">1</span>  Oscillograms</a></li>
  <li><a href="#power-spectra" id="toc-power-spectra" class="nav-link" data-scroll-target="#power-spectra"><span class="toc-section-number">2</span>  Power Spectra</a></li>
  <li><a href="#wave-manipulation" id="toc-wave-manipulation" class="nav-link" data-scroll-target="#wave-manipulation"><span class="toc-section-number">3</span>  Wave manipulation</a></li>
  <li><a href="#measurements" id="toc-measurements" class="nav-link" data-scroll-target="#measurements"><span class="toc-section-number">4</span>  Measurements</a></li>
  </ul>
</nav>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><font size="7"><b>Seewave</b></font></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>&nbsp;</p>
<section id="objetives" class="level2 unnumbered unlisted alert alert-info">
<h2 class="unnumbered unlisted anchored" data-anchor-id="objetives"><strong>Objetives</strong></h2>
<ul>
<li><p>Understand the most common metrics of acoustic structure</p></li>
<li><p>Get familiar with manipulating and formatting sound in the R environment</p></li>
</ul>
</section>
<p>&nbsp;</p>
<p><strong>seewave</strong> provides a wide variety of tools to accurately assess sound properties in the R environment. It is an extensive package with lots of features. The package allows to visualize and measure characteristics of time, frequency and amplitude of sounds. The tools are arranged in a modular way (each analysis in its own function) which allows combining them to generate more elaborate analyzes.</p>
<p>The majority of the functions of <strong>seewave</strong> work on wave objects (but not on audio files in folders). Here we will see examples of some of these tools, focusing on those that are potentially more useful for the study of vocal behavior in animals.</p>
<p>First we must load the package:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(seewave)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We can see the description of the package <strong>seewave</strong> in this way:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>?seewave</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="example-data-in-seewave" class="level3" data-number="0.1">
<h3 data-number="0.1" class="anchored" data-anchor-id="example-data-in-seewave"><span class="header-section-number">0.1</span> Example data in seewave</h3>
<p><strong>seewave</strong> brings several objects that we can use as an example to explore its functions. We can call them with the <code>data ()</code> function:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cargar ejemplos</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(tico)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(orni)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(sheep)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>&nbsp;</p>
<div class="alert alert-warning">
<p>⚠ <code>data()</code> only works to load examples that come with the packages by default, not to load your own audio files!!</p>
</div>
<p>&nbsp;</p>
<p>We can see the information of each of them using <code>?</code>:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>?tico</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>&nbsp;</p>
<div class="alert alert-info">
<p><font size="5">Exercise</font></p>
<p>What kind of object is <code>tico</code>?</p>
<p>What is the sampling rate and duration?</p>
</div>
<p>&nbsp;</p>
</section>
<section id="oscillograms" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="oscillograms"><span class="header-section-number">1</span> Oscillograms</h2>
<p>You can create the oscillogram of the entire “wave” object like this:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">oscillo</span>(tico) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="seewave_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can also generate it for a segment:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">oscillo</span>(tico, <span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="seewave_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The visualizations in <strong>seewave</strong> allow a high degree of customization. For example change the color:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">oscillo</span>(tico, <span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">colwave =</span> <span class="st">"#8fcc78"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="seewave_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>As with most <strong>seewave</strong> functions many other components of the chart can be modified, for example:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># grey background</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>op <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">bg =</span> <span class="st">"grey"</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">oscillo</span>(tico, <span class="at">f =</span> <span class="dv">22050</span>, <span class="at">k =</span> <span class="dv">4</span> , <span class="at">j =</span> <span class="dv">1</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">colwave =</span> <span class="st">"black"</span>, </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">coltitle =</span> <span class="st">"yellow"</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">collab =</span> <span class="st">"red"</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">colline =</span> <span class="st">"white"</span>,</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">colaxis =</span> <span class="st">"blue"</span>,</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">coly0 =</span> <span class="st">"grey50"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="seewave_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>&nbsp;</p>
<p>We can also generate other representations of “amplitude vs.&nbsp;time”, such as “amplitude envelopes”:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">env</span>(tico, <span class="at">f =</span> <span class="dv">22050</span>, <span class="at">colwave =</span> <span class="st">"#8fcc78"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="seewave_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can superimpose it on the oscillogram to facilitate comparison:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">oscillo</span>(tico, <span class="at">f =</span> <span class="dv">22050</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span><span class="cn">TRUE</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">env</span>(tico, <span class="at">f =</span> <span class="dv">22050</span>, <span class="at">colwave =</span> <span class="st">"#8fcc78"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="seewave_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">

</div>
<p>&nbsp;</p>
<div class="alert alert-success">
<p><font size="3"><b>Sliding window for time series</b></font></p>
<p>&nbsp;</p>
<p>Sliding windows allow you to smooth out the contours of a time series by calculating an average value around the “neighborhood” of values for a given value. In the case of amplitude envelope the size of the “neighborhood” is given by the length of the window (“wl”). The larger the window length, the greater the smoothing of the curve:</p>
<p>&nbsp;</p>
<p><img src="images/env_sliding_window_ENG_v2.gif" alt="Sliding window"></p>
<p>&nbsp;</p>
<p>This animation shows how the amplitude envelope of the “tico” object is smoothed with a 512-point window:</p>
<p>&nbsp;</p>
<p><img src="images/env_sliding_window_scheme_ENG_v2_512.gif" alt="Sliding window"></p>
<p>&nbsp;</p>
<p>… or a 1024 point window:</p>
<p>&nbsp;</p>
<p><img src="images/env_sliding_window_scheme_ENG_v2_512.gif" alt="Sliding window"></p>
<p>&nbsp;</p>
</div>
<p>&nbsp;</p>
<p>We can use these amplitude “hills” to define segments in the “wave” object using the <code>timer()</code> function. The “ssmooth” argument allows us to use a sliding window:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>tmr <span class="ot">&lt;-</span> <span class="fu">timer</span>(orni, <span class="at">f =</span> <span class="dv">22050</span>, <span class="at">threshold =</span> <span class="dv">5</span>, <span class="at">ssmooth =</span> <span class="dv">40</span>, </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">bty =</span> <span class="st">"l"</span>, <span class="at">colval =</span> <span class="st">"#51c724"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="seewave_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>tmr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$s
[1] 6.013985e-02 5.918741e-02 5.134111e-02 4.535434e-05 5.728253e-02
[6] 4.535434e-05 6.667088e-03 4.535434e-05 4.966300e-02

$p
 [1] 2.208756e-02 1.004599e-01 8.272631e-02 2.267717e-04 8.594647e-02
 [6] 4.535434e-05 8.132033e-02 4.988977e-04 4.535434e-05 6.068410e-02

$r
[1] 0.6552769

$s.start
[1] 0.02208756 0.18268727 0.32460099 0.37616887 0.46216069 0.51948857 0.60085425
[8] 0.60802024 0.60811095

$s.end
[1] 0.08222741 0.24187468 0.37594210 0.37621422 0.51944322 0.51953393 0.60752134
[8] 0.60806559 0.65777395

$first
[1] "pause"</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>The output is a list with the following elements:</p>
<ul>
<li><strong>s</strong>: duration of detected signals (in s)</li>
<li><strong>p</strong>: duration of pauses (i.e.&nbsp;gaps) between signals</li>
<li><strong>r</strong>: ratio of <strong>s</strong> to <strong>r</strong></li>
<li><strong>s.start</strong>: start of signals</li>
<li><strong>end</strong>: end of signals</li>
</ul>
<p>&nbsp;</p>
<div class="alert alert-info">
<p><font size="5">Exercise</font></p>
<ul>
<li>In the previous example using <code>timer()</code> the last pulse is divided into 2 detections, one very small at the beginning and another containing the rest of the pulse. Change the “ssmooth” argument until this section is detected as a single pulse.</li>
</ul>
</div>
<p>&nbsp;</p>
</section>
<section id="power-spectra" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="power-spectra"><span class="header-section-number">2</span> Power Spectra</h2>
<p>We can visualize the amplitude in the frequency domain using power spectra. The <code>meanspec()</code> function calculates the average distribution of energy in the frequency range (the average power spectrum):</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>mspc <span class="ot">&lt;-</span> <span class="fu">meanspec</span>(orni, <span class="at">f =</span> <span class="dv">22050</span>, <span class="at">wl =</span> <span class="dv">512</span>, <span class="at">col =</span> <span class="st">"#daeace"</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), mspc), <span class="at">col =</span> <span class="st">"#daeace"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="seewave_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(mspc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 256</code></pre>
</div>
</div>
<p>The <code>spec()</code> function, on the other hand, calculates the spectrum for the entire signal:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>spc <span class="ot">&lt;-</span> <span class="fu">spec</span>(orni, <span class="at">f=</span><span class="dv">22050</span>, <span class="at">wl=</span><span class="dv">512</span>, <span class="at">col =</span> <span class="st">"#8fcc78"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="seewave_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(spc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7921</code></pre>
</div>
</div>
<p>The result of <code>spec()</code> or <code>meanspec()</code> can be input into the <code>fpeaks()</code> function to calculate amplitude peaks:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>pks <span class="ot">&lt;-</span> <span class="fu">fpeaks</span>(spc, <span class="at">nmax =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="seewave_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>pks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         [,1] [,2]
[1,] 4.860409    1</code></pre>
</div>
</div>
<p>&nbsp;</p>
</section>
<section id="wave-manipulation" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="wave-manipulation"><span class="header-section-number">3</span> Wave manipulation</h2>
<p>We can cut segments of a “wave” object:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>tico2 <span class="ot">&lt;-</span> <span class="fu">cutw</span>(tico, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">output =</span> <span class="st">"Wave"</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">oscillo</span>(tico2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="seewave_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Add segments:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>tico3 <span class="ot">&lt;-</span> <span class="fu">pastew</span>(tico, tico2, <span class="at">output =</span> <span class="st">"Wave"</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">oscillo</span>(tico3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="seewave_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>This took quite a lot of time to display this graphic, you may set 'fastdisp=TRUE' for a faster, but less accurate, display</code></pre>
</div>
</div>
<p>Remove segments:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>tico4 <span class="ot">&lt;-</span> <span class="fu">deletew</span>(tico3, <span class="at">output =</span> <span class="st">"Wave"</span>, <span class="at">from =</span> <span class="fu">duration</span>(tico), <span class="at">to =</span> <span class="fu">duration</span>(tico3))</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">oscillo</span>(tico4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="seewave_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Add segments of silence:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>tico5 <span class="ot">&lt;-</span> <span class="fu">addsilw</span>(tico, <span class="at">at =</span> <span class="st">"end"</span>, <span class="at">d =</span> <span class="dv">1</span>, <span class="at">output =</span> <span class="st">"Wave"</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">duration</span>(tico)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.794921</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">duration</span>(tico5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.794921</code></pre>
</div>
</div>
<p>&nbsp;</p>
<div class="alert alert-info">
<p><font size="5">Exercise</font></p>
<ul>
<li>The function <code>rev()</code> can reverse te order of a vector:</li>
</ul>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>v1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rev</span>(v1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3 2 1</code></pre>
</div>
</div>
<ul>
<li>Reverse the amplitude vector of ‘tico’ and generate a spectrogram of the reversed wave object</li>
</ul>
</div>
<p>&nbsp;</p>
<p>Filter out frequency bands:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># original</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">spectro</span>(tico, <span class="at">scale =</span> <span class="cn">FALSE</span>, <span class="at">grid =</span> <span class="cn">FALSE</span>, <span class="at">flim =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="seewave_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># filtered</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">spectro</span>(<span class="fu">ffilter</span>(tico, <span class="at">from =</span> <span class="dv">4000</span>, <span class="at">to =</span> <span class="dv">6500</span>, <span class="at">output =</span> <span class="st">"Wave"</span>), <span class="at">scale =</span> <span class="cn">FALSE</span>, <span class="at">grid =</span> <span class="cn">FALSE</span>, <span class="at">flim =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="seewave_files/figure-html/unnamed-chunk-20-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Change frequency (pitch):</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cut the first</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>tico6 <span class="ot">&lt;-</span> <span class="fu">cutw</span>(tico, <span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="fl">0.5</span>, <span class="at">output =</span> <span class="st">"Wave"</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># increase frec</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>tico.lfs <span class="ot">&lt;-</span> <span class="fu">lfs</span>(tico6, <span class="at">shift =</span> <span class="dv">1000</span>, <span class="at">output =</span> <span class="st">"Wave"</span>)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="co"># decrease frec</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>tico.lfs.neg <span class="ot">&lt;-</span> <span class="fu">lfs</span>(tico6, <span class="at">shift =</span> <span class="sc">-</span><span class="dv">1000</span>, <span class="at">output =</span> <span class="st">"Wave"</span>)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 3 column graph</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>opar <span class="ot">&lt;-</span> <span class="fu">par</span>()</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="co"># original</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="fu">spectro</span>(tico6, <span class="at">scale =</span> <span class="cn">FALSE</span>, <span class="at">grid =</span> <span class="cn">FALSE</span>, <span class="at">flim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">8</span>), <span class="at">main =</span> <span class="st">"original"</span>)</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a><span class="co"># modified</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a><span class="fu">spectro</span>(tico.lfs, <span class="at">scale =</span> <span class="cn">FALSE</span>, <span class="at">grid =</span> <span class="cn">FALSE</span>, <span class="at">flim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">8</span>), <span class="at">main =</span> <span class="st">"1 kHz up"</span>)</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a><span class="fu">spectro</span>(tico.lfs.neg, <span class="at">scale =</span> <span class="cn">FALSE</span>, <span class="at">grid =</span> <span class="cn">FALSE</span>, <span class="at">flim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">8</span>), <span class="at">main =</span> <span class="st">"1 kHz down"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="seewave_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(opar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="measurements" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="measurements"><span class="header-section-number">4</span> Measurements</h2>
<p>&nbsp;</p>
<p>Apart from the measurements of peak frequency (<code>fpeaks()</code>) and duration (<code>timer()</code>), we can measure many other aspects of the acoustic signals using <strong>seewave</strong>. For example, we can estimate the fundamental frequency (which refers to the lowest frequency harmonic in the harmonic stack), with the <code>fund()</code> function:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">spectro</span>(sheep, <span class="at">scale =</span> <span class="cn">FALSE</span>, <span class="at">grid =</span> <span class="cn">FALSE</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span><span class="cn">TRUE</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>ff <span class="ot">&lt;-</span> <span class="fu">fund</span>(sheep, <span class="at">fmax =</span> <span class="dv">300</span>, <span class="at">ann =</span> <span class="cn">FALSE</span>, <span class="at">threshold=</span><span class="dv">6</span>, <span class="at">col =</span> <span class="st">"green"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="seewave_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>              x          y
[1,] 0.00000000         NA
[2,] 0.06677027         NA
[3,] 0.13354054         NA
[4,] 0.20031081         NA
[5,] 0.26708108 0.10000000
[6,] 0.33385135 0.07142857</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>This function uses cepstral transformation to detect the dominant frequency. The <code>autoc()</code> function also measures the fundamental frequency, only using autocorrelation.</p>
<p>Similarly we can measure the dominant frequency (the harmonic with the highest energy):</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span><span class="cn">TRUE</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">dfreq</span>(sheep, <span class="at">f =</span> <span class="dv">8000</span>, <span class="at">fmax =</span> <span class="dv">300</span>, <span class="at">type =</span> <span class="st">"p"</span>, <span class="at">pch =</span> <span class="dv">24</span>, <span class="at">ann =</span> <span class="cn">FALSE</span>, <span class="at">threshold =</span> <span class="dv">6</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="seewave_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>              x        y
[1,] 0.00000000       NA
[2,] 0.06677027       NA
[3,] 0.13354054       NA
[4,] 0.20031081       NA
[5,] 0.26708108 0.484375
[6,] 0.33385135 0.625000</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>Measure statistical descriptors of the amplitude distribution in frequency and time:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cut</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>note2 <span class="ot">&lt;-</span> <span class="fu">cutw</span>(tico, <span class="at">from=</span><span class="fl">0.6</span>, <span class="at">to=</span><span class="fl">0.9</span>, <span class="at">output=</span><span class="st">"Wave"</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>n2.as <span class="ot">&lt;-</span> <span class="fu">acoustat</span>(note2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="seewave_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(n2.as[<span class="dv">3</span><span class="sc">:</span><span class="dv">8</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">time.P1</th>
<th style="text-align: right;">time.M</th>
<th style="text-align: right;">time.P2</th>
<th style="text-align: right;">time.IPR</th>
<th style="text-align: right;">freq.P1</th>
<th style="text-align: right;">freq.M</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.0272727</td>
<td style="text-align: right;">0.1090909</td>
<td style="text-align: right;">0.2181818</td>
<td style="text-align: right;">0.1909091</td>
<td style="text-align: right;">3.445312</td>
<td style="text-align: right;">4.263574</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>Measure statistical descriptors of frequency spectra:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># measure power spectrum</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>n2.sp <span class="ot">&lt;-</span> <span class="fu">meanspec</span>(note2, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>n2.spcp <span class="ot">&lt;-</span> <span class="fu">specprop</span>(n2.sp, <span class="at">f =</span> note2<span class="sc">@</span>samp.rate)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(n2.spcp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">median</th>
<th style="text-align: right;">sem</th>
<th style="text-align: right;">mode</th>
<th style="text-align: right;">Q25</th>
<th style="text-align: right;">Q75</th>
<th style="text-align: right;">IQR</th>
<th style="text-align: right;">cent</th>
<th style="text-align: right;">skewness</th>
<th style="text-align: right;">kurtosis</th>
<th style="text-align: right;">sfm</th>
<th style="text-align: right;">sh</th>
<th style="text-align: right;">prec</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">4346.889</td>
<td style="text-align: right;">694.2615</td>
<td style="text-align: right;">4306.641</td>
<td style="text-align: right;">43.39134</td>
<td style="text-align: right;">4349.707</td>
<td style="text-align: right;">3789.844</td>
<td style="text-align: right;">4780.371</td>
<td style="text-align: right;">990.5273</td>
<td style="text-align: right;">4346.889</td>
<td style="text-align: right;">2.224789</td>
<td style="text-align: right;">6.645413</td>
<td style="text-align: right;">0.023993</td>
<td style="text-align: right;">0.6968186</td>
<td style="text-align: right;">43.06641</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>&nbsp;</p>
<div class="alert alert-info">
<p><font size="5">Exercise</font></p>
<ul>
<li>Measure the statistical descriptors of the frequency spectra (function <code>specprop()</code>) on the 3 notes (hint: you must cut each note first)</li>
</ul>
</div>
<p>&nbsp;</p>
<hr>
<p><font size="4">Session information</font></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.2.2 Patched (2022-11-10 r83330)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=es_ES.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=es_CR.UTF-8        LC_COLLATE=es_ES.UTF-8    
 [5] LC_MONETARY=es_CR.UTF-8    LC_MESSAGES=es_ES.UTF-8   
 [7] LC_PAPER=es_CR.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=es_CR.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] seewave_2.2.0

loaded via a namespace (and not attached):
 [1] digest_0.6.31     MASS_7.3-58.2     jsonlite_1.8.4    signal_0.7-7     
 [5] evaluate_0.21     rlang_1.1.1       cli_3.6.1         rstudioapi_0.14  
 [9] rmarkdown_2.19    tools_4.2.2       tuneR_1.4.4       htmlwidgets_1.5.4
[13] xfun_0.39         yaml_2.3.7        fastmap_1.1.1     compiler_4.2.2   
[17] htmltools_0.5.5   knitr_1.42       </code></pre>
</div>
</div>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp(/https:\/\/marce10\.github\.io\/OTS_BIR_2023\//);
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          // default icon
          link.classList.add("external");
      }
    }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb46" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> &lt;font size="7"&gt;&lt;b&gt;Seewave&lt;/b&gt;&lt;/font&gt;</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="an">toc:</span><span class="co"> true</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="an">toc-depth:</span><span class="co"> 2</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="an">toc-location:</span><span class="co"> left</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="an">number-sections:</span><span class="co"> true</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="an">highlight-style:</span><span class="co"> pygments</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="co">    df-print: kable</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: show</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a><span class="co">    css: styles.css</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a><span class="co">    link-external-icon: true</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a><span class="co">    link-external-newwindow: true  </span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-info}</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a><span class="fu">## **Objetives** {.unnumbered .unlisted}</span></span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Understand the most common metrics of acoustic structure</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Get familiar with manipulating and formatting sound in the R environment</span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a>**seewave** provides a wide variety of tools to accurately assess sound properties in the R environment. It is an extensive package with lots of features. The package allows to visualize and measure characteristics of time, frequency and amplitude of sounds. The tools are arranged in a modular way (each analysis in its own function) which allows combining them to generate more elaborate analyzes.</span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a>The majority of the functions of **seewave** work on wave objects (but not on audio files in folders). Here we will see examples of some of these tools, focusing on those that are potentially more useful for the study of vocal behavior in animals.</span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a>First we must load the package:</span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(seewave)</span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-45"><a href="#cb46-45" aria-hidden="true" tabindex="-1"></a>We can see the description of the package **seewave** in this way:</span>
<span id="cb46-46"><a href="#cb46-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-47"><a href="#cb46-47" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = FALSE}</span></span>
<span id="cb46-48"><a href="#cb46-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-49"><a href="#cb46-49" aria-hidden="true" tabindex="-1"></a>?seewave</span>
<span id="cb46-50"><a href="#cb46-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-51"><a href="#cb46-51" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-52"><a href="#cb46-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-53"><a href="#cb46-53" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example data in seewave</span></span>
<span id="cb46-54"><a href="#cb46-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-55"><a href="#cb46-55" aria-hidden="true" tabindex="-1"></a>**seewave** brings several objects that we can use as an example to explore its functions. We can call them with the <span class="in">`data ()`</span> function:</span>
<span id="cb46-56"><a href="#cb46-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-57"><a href="#cb46-57" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=TRUE}</span></span>
<span id="cb46-58"><a href="#cb46-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-59"><a href="#cb46-59" aria-hidden="true" tabindex="-1"></a><span class="co"># cargar ejemplos</span></span>
<span id="cb46-60"><a href="#cb46-60" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(tico)</span>
<span id="cb46-61"><a href="#cb46-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-62"><a href="#cb46-62" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(orni)</span>
<span id="cb46-63"><a href="#cb46-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-64"><a href="#cb46-64" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(sheep)</span>
<span id="cb46-65"><a href="#cb46-65" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-66"><a href="#cb46-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-67"><a href="#cb46-67" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb46-68"><a href="#cb46-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-69"><a href="#cb46-69" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-warning}</span>
<span id="cb46-70"><a href="#cb46-70" aria-hidden="true" tabindex="-1"></a>⚠ <span class="in">`data()`</span> only works to load examples that come with the packages by default, not to load your own audio files!!</span>
<span id="cb46-71"><a href="#cb46-71" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-72"><a href="#cb46-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-73"><a href="#cb46-73" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb46-74"><a href="#cb46-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-75"><a href="#cb46-75" aria-hidden="true" tabindex="-1"></a>We can see the information of each of them using <span class="in">`?`</span>:</span>
<span id="cb46-76"><a href="#cb46-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-77"><a href="#cb46-77" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb46-78"><a href="#cb46-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-79"><a href="#cb46-79" aria-hidden="true" tabindex="-1"></a>?tico</span>
<span id="cb46-80"><a href="#cb46-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-81"><a href="#cb46-81" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-82"><a href="#cb46-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-83"><a href="#cb46-83" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb46-84"><a href="#cb46-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-85"><a href="#cb46-85" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-info}</span>
<span id="cb46-86"><a href="#cb46-86" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;font</span> <span class="er">size</span><span class="ot">=</span><span class="st">"5"</span><span class="kw">&gt;</span>Exercise<span class="kw">&lt;/font&gt;</span></span>
<span id="cb46-87"><a href="#cb46-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-88"><a href="#cb46-88" aria-hidden="true" tabindex="-1"></a>What kind of object is <span class="in">`tico`</span>?</span>
<span id="cb46-89"><a href="#cb46-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-90"><a href="#cb46-90" aria-hidden="true" tabindex="-1"></a>What is the sampling rate and duration?</span>
<span id="cb46-91"><a href="#cb46-91" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-92"><a href="#cb46-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-93"><a href="#cb46-93" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb46-94"><a href="#cb46-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-95"><a href="#cb46-95" aria-hidden="true" tabindex="-1"></a><span class="fu">## Oscillograms</span></span>
<span id="cb46-96"><a href="#cb46-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-97"><a href="#cb46-97" aria-hidden="true" tabindex="-1"></a>You can create the oscillogram of the entire "wave" object like this:</span>
<span id="cb46-98"><a href="#cb46-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-101"><a href="#cb46-101" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-102"><a href="#cb46-102" aria-hidden="true" tabindex="-1"></a><span class="fu">oscillo</span>(tico) </span>
<span id="cb46-103"><a href="#cb46-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-104"><a href="#cb46-104" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-105"><a href="#cb46-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-106"><a href="#cb46-106" aria-hidden="true" tabindex="-1"></a>We can also generate it for a segment:</span>
<span id="cb46-107"><a href="#cb46-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-110"><a href="#cb46-110" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-111"><a href="#cb46-111" aria-hidden="true" tabindex="-1"></a><span class="fu">oscillo</span>(tico, <span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>)</span>
<span id="cb46-112"><a href="#cb46-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-113"><a href="#cb46-113" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-114"><a href="#cb46-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-115"><a href="#cb46-115" aria-hidden="true" tabindex="-1"></a>The visualizations in **seewave** allow a high degree of customization. For example change the color:</span>
<span id="cb46-116"><a href="#cb46-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-119"><a href="#cb46-119" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-120"><a href="#cb46-120" aria-hidden="true" tabindex="-1"></a><span class="fu">oscillo</span>(tico, <span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">colwave =</span> <span class="st">"#8fcc78"</span>)</span>
<span id="cb46-121"><a href="#cb46-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-122"><a href="#cb46-122" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-123"><a href="#cb46-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-124"><a href="#cb46-124" aria-hidden="true" tabindex="-1"></a>As with most **seewave** functions many other components of the chart can be modified, for example:</span>
<span id="cb46-125"><a href="#cb46-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-128"><a href="#cb46-128" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-129"><a href="#cb46-129" aria-hidden="true" tabindex="-1"></a><span class="co"># grey background</span></span>
<span id="cb46-130"><a href="#cb46-130" aria-hidden="true" tabindex="-1"></a>op <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">bg =</span> <span class="st">"grey"</span>)</span>
<span id="cb46-131"><a href="#cb46-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-132"><a href="#cb46-132" aria-hidden="true" tabindex="-1"></a><span class="fu">oscillo</span>(tico, <span class="at">f =</span> <span class="dv">22050</span>, <span class="at">k =</span> <span class="dv">4</span> , <span class="at">j =</span> <span class="dv">1</span>,</span>
<span id="cb46-133"><a href="#cb46-133" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="cn">TRUE</span>,</span>
<span id="cb46-134"><a href="#cb46-134" aria-hidden="true" tabindex="-1"></a>        <span class="at">colwave =</span> <span class="st">"black"</span>, </span>
<span id="cb46-135"><a href="#cb46-135" aria-hidden="true" tabindex="-1"></a>        <span class="at">coltitle =</span> <span class="st">"yellow"</span>,</span>
<span id="cb46-136"><a href="#cb46-136" aria-hidden="true" tabindex="-1"></a>        <span class="at">collab =</span> <span class="st">"red"</span>,</span>
<span id="cb46-137"><a href="#cb46-137" aria-hidden="true" tabindex="-1"></a>        <span class="at">colline =</span> <span class="st">"white"</span>,</span>
<span id="cb46-138"><a href="#cb46-138" aria-hidden="true" tabindex="-1"></a>        <span class="at">colaxis =</span> <span class="st">"blue"</span>,</span>
<span id="cb46-139"><a href="#cb46-139" aria-hidden="true" tabindex="-1"></a>        <span class="at">coly0 =</span> <span class="st">"grey50"</span>)</span>
<span id="cb46-140"><a href="#cb46-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-141"><a href="#cb46-141" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-142"><a href="#cb46-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-143"><a href="#cb46-143" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb46-144"><a href="#cb46-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-145"><a href="#cb46-145" aria-hidden="true" tabindex="-1"></a>We can also generate other representations of "amplitude vs. time", such as "amplitude envelopes":</span>
<span id="cb46-146"><a href="#cb46-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-149"><a href="#cb46-149" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-150"><a href="#cb46-150" aria-hidden="true" tabindex="-1"></a><span class="fu">env</span>(tico, <span class="at">f =</span> <span class="dv">22050</span>, <span class="at">colwave =</span> <span class="st">"#8fcc78"</span>)</span>
<span id="cb46-151"><a href="#cb46-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-152"><a href="#cb46-152" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-153"><a href="#cb46-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-154"><a href="#cb46-154" aria-hidden="true" tabindex="-1"></a>We can superimpose it on the oscillogram to facilitate comparison:</span>
<span id="cb46-155"><a href="#cb46-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-158"><a href="#cb46-158" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-159"><a href="#cb46-159" aria-hidden="true" tabindex="-1"></a><span class="fu">oscillo</span>(tico, <span class="at">f =</span> <span class="dv">22050</span>)</span>
<span id="cb46-160"><a href="#cb46-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-161"><a href="#cb46-161" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span><span class="cn">TRUE</span>)</span>
<span id="cb46-162"><a href="#cb46-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-163"><a href="#cb46-163" aria-hidden="true" tabindex="-1"></a><span class="fu">env</span>(tico, <span class="at">f =</span> <span class="dv">22050</span>, <span class="at">colwave =</span> <span class="st">"#8fcc78"</span>)</span>
<span id="cb46-164"><a href="#cb46-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-165"><a href="#cb46-165" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-166"><a href="#cb46-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-167"><a href="#cb46-167" aria-hidden="true" tabindex="-1"></a><span class="in">```{r animation sliding window, eval = F, echo = FALSE}</span></span>
<span id="cb46-168"><a href="#cb46-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-169"><a href="#cb46-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-170"><a href="#cb46-170" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"animation"</span>)</span>
<span id="cb46-171"><a href="#cb46-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-172"><a href="#cb46-172" aria-hidden="true" tabindex="-1"></a>sq <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">1200</span>, <span class="at">length.out =</span> <span class="dv">15</span>))</span>
<span id="cb46-173"><a href="#cb46-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-174"><a href="#cb46-174" aria-hidden="true" tabindex="-1"></a><span class="co"># loop over different number of time windows</span></span>
<span id="cb46-175"><a href="#cb46-175" aria-hidden="true" tabindex="-1"></a><span class="fu">saveGIF</span>(</span>
<span id="cb46-176"><a href="#cb46-176" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span>(x <span class="cf">in</span> sq)</span>
<span id="cb46-177"><a href="#cb46-177" aria-hidden="true" tabindex="-1"></a>  { </span>
<span id="cb46-178"><a href="#cb46-178" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">bg =</span> <span class="st">"#daeace"</span>) </span>
<span id="cb46-179"><a href="#cb46-179" aria-hidden="true" tabindex="-1"></a>  envlp <span class="ot">&lt;-</span><span class="fu">env</span>(tico, <span class="at">ssmooth =</span> x)</span>
<span id="cb46-180"><a href="#cb46-180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">box</span>()</span>
<span id="cb46-181"><a href="#cb46-181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">title</span>(<span class="fu">paste</span>(<span class="st">"Window length ="</span>, x))</span>
<span id="cb46-182"><a href="#cb46-182" aria-hidden="true" tabindex="-1"></a>},</span>
<span id="cb46-183"><a href="#cb46-183" aria-hidden="true" tabindex="-1"></a><span class="at">movie.name =</span>  <span class="st">"env_sliding_window_ENG_v2.gif"</span>, <span class="at">interval =</span> <span class="fl">0.5</span>, <span class="at">ani.height =</span> <span class="dv">480</span> <span class="sc">/</span> <span class="fl">1.5</span>, <span class="at">res =</span> <span class="dv">70</span>)</span>
<span id="cb46-184"><a href="#cb46-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-185"><a href="#cb46-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-186"><a href="#cb46-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-187"><a href="#cb46-187" aria-hidden="true" tabindex="-1"></a>wl <span class="ot">&lt;-</span> <span class="dv">512</span></span>
<span id="cb46-188"><a href="#cb46-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-189"><a href="#cb46-189" aria-hidden="true" tabindex="-1"></a><span class="co"># run from here</span></span>
<span id="cb46-190"><a href="#cb46-190" aria-hidden="true" tabindex="-1"></a>envlp <span class="ot">&lt;-</span><span class="fu">env</span>(tico, <span class="at">ssmooth =</span> wl, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb46-191"><a href="#cb46-191" aria-hidden="true" tabindex="-1"></a>envlp <span class="ot">&lt;-</span> envlp<span class="sc">/</span><span class="fu">max</span>(envlp)</span>
<span id="cb46-192"><a href="#cb46-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-193"><a href="#cb46-193" aria-hidden="true" tabindex="-1"></a>envlp1 <span class="ot">&lt;-</span> <span class="fu">env</span>(tico, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb46-194"><a href="#cb46-194" aria-hidden="true" tabindex="-1"></a>envlp1 <span class="ot">&lt;-</span> envlp1<span class="sc">/</span><span class="fu">max</span>(envlp1)</span>
<span id="cb46-195"><a href="#cb46-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-196"><a href="#cb46-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-197"><a href="#cb46-197" aria-hidden="true" tabindex="-1"></a><span class="fu">saveGIF</span>(</span>
<span id="cb46-198"><a href="#cb46-198" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span>(x <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>,(<span class="fu">nrow</span>(envlp1) <span class="sc">-</span> wl) ,<span class="at">by =</span> <span class="dv">500</span>))</span>
<span id="cb46-199"><a href="#cb46-199" aria-hidden="true" tabindex="-1"></a>  { </span>
<span id="cb46-200"><a href="#cb46-200" aria-hidden="true" tabindex="-1"></a>   <span class="fu">par</span>(<span class="at">bg =</span> <span class="st">"#daeace"</span>)</span>
<span id="cb46-201"><a href="#cb46-201" aria-hidden="true" tabindex="-1"></a>   <span class="fu">plot</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">duration</span>(tico)), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">col =</span> <span class="st">"white"</span>, <span class="at">yaxt =</span> <span class="st">"n"</span>, <span class="at">xlab =</span> <span class="st">"Time"</span>, <span class="at">ylab =</span> <span class="st">"Amplitude"</span>)</span>
<span id="cb46-202"><a href="#cb46-202" aria-hidden="true" tabindex="-1"></a>   <span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"gray"</span>)</span>
<span id="cb46-203"><a href="#cb46-203" aria-hidden="true" tabindex="-1"></a>   envlp1[<span class="dv">1</span><span class="sc">:</span>x,] <span class="ot">&lt;-</span> envlp[<span class="dv">1</span><span class="sc">:</span>x,]</span>
<span id="cb46-204"><a href="#cb46-204" aria-hidden="true" tabindex="-1"></a>   <span class="fu">lines</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">duration</span>(tico), <span class="at">length.out =</span> <span class="fu">nrow</span>(envlp1)), <span class="at">y =</span> envlp1[,<span class="dv">1</span>])</span>
<span id="cb46-205"><a href="#cb46-205" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb46-206"><a href="#cb46-206" aria-hidden="true" tabindex="-1"></a>   <span class="fu">lines</span>(<span class="at">x =</span> (x<span class="sc">:</span>(x <span class="sc">+</span> wl)) <span class="sc">/</span> tico<span class="sc">@</span>samp.rate, <span class="at">y =</span> <span class="fu">rep</span>(<span class="dv">0</span>, wl <span class="sc">+</span> <span class="dv">1</span>), <span class="at">lwd =</span> <span class="dv">7</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb46-207"><a href="#cb46-207" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb46-208"><a href="#cb46-208" aria-hidden="true" tabindex="-1"></a>   <span class="fu">title</span>(<span class="fu">paste</span>(<span class="st">"Window length ="</span>, wl))</span>
<span id="cb46-209"><a href="#cb46-209" aria-hidden="true" tabindex="-1"></a>},</span>
<span id="cb46-210"><a href="#cb46-210" aria-hidden="true" tabindex="-1"></a><span class="at">movie.name =</span>  <span class="fu">paste0</span>(<span class="st">"env_sliding_window_scheme_ENG_v2_"</span>, wl, <span class="st">".gif"</span>), <span class="at">interval =</span> <span class="fl">0.2</span>, <span class="at">ani.height =</span> <span class="dv">480</span> <span class="sc">/</span> <span class="fl">1.5</span>, <span class="at">res =</span> <span class="dv">70</span>)</span>
<span id="cb46-211"><a href="#cb46-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-212"><a href="#cb46-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-213"><a href="#cb46-213" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-214"><a href="#cb46-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-215"><a href="#cb46-215" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb46-216"><a href="#cb46-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-217"><a href="#cb46-217" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-success}</span>
<span id="cb46-218"><a href="#cb46-218" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;font</span> <span class="er">size</span><span class="ot">=</span><span class="st">"3"</span><span class="kw">&gt;&lt;b&gt;</span>Sliding window for time series<span class="kw">&lt;/b&gt;&lt;/font&gt;</span></span>
<span id="cb46-219"><a href="#cb46-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-220"><a href="#cb46-220" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb46-221"><a href="#cb46-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-222"><a href="#cb46-222" aria-hidden="true" tabindex="-1"></a>Sliding windows allow you to smooth out the contours of a time series by calculating an average value around the "neighborhood" of values for a given value. In the case of amplitude envelope the size of the "neighborhood" is given by the length of the window ("wl"). The larger the window length, the greater the smoothing of the curve:</span>
<span id="cb46-223"><a href="#cb46-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-224"><a href="#cb46-224" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb46-225"><a href="#cb46-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-226"><a href="#cb46-226" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;img</span> <span class="er">src</span><span class="ot">=</span><span class="st">"images/env_sliding_window_ENG_v2.gif"</span> <span class="er">alt</span><span class="ot">=</span><span class="st">"Sliding window"</span><span class="kw">/&gt;</span></span>
<span id="cb46-227"><a href="#cb46-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-228"><a href="#cb46-228" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb46-229"><a href="#cb46-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-230"><a href="#cb46-230" aria-hidden="true" tabindex="-1"></a>This animation shows how the amplitude envelope of the "tico" object is smoothed with a 512-point window:</span>
<span id="cb46-231"><a href="#cb46-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-232"><a href="#cb46-232" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb46-233"><a href="#cb46-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-234"><a href="#cb46-234" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;img</span> <span class="er">src</span><span class="ot">=</span><span class="st">"images/env_sliding_window_scheme_ENG_v2_512.gif"</span> <span class="er">alt</span><span class="ot">=</span><span class="st">"Sliding window"</span><span class="kw">/&gt;</span></span>
<span id="cb46-235"><a href="#cb46-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-236"><a href="#cb46-236" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb46-237"><a href="#cb46-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-238"><a href="#cb46-238" aria-hidden="true" tabindex="-1"></a>... or a 1024 point window:</span>
<span id="cb46-239"><a href="#cb46-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-240"><a href="#cb46-240" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb46-241"><a href="#cb46-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-242"><a href="#cb46-242" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;img</span> <span class="er">src</span><span class="ot">=</span><span class="st">"images/env_sliding_window_scheme_ENG_v2_512.gif"</span> <span class="er">alt</span><span class="ot">=</span><span class="st">"Sliding window"</span><span class="kw">/&gt;</span></span>
<span id="cb46-243"><a href="#cb46-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-244"><a href="#cb46-244" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb46-245"><a href="#cb46-245" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-246"><a href="#cb46-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-247"><a href="#cb46-247" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb46-248"><a href="#cb46-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-249"><a href="#cb46-249" aria-hidden="true" tabindex="-1"></a>We can use these amplitude "hills" to define segments in the "wave" object using the <span class="in">`timer()`</span> function. The "ssmooth" argument allows us to use a sliding window:</span>
<span id="cb46-250"><a href="#cb46-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-251"><a href="#cb46-251" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = T, echo = T}</span></span>
<span id="cb46-252"><a href="#cb46-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-253"><a href="#cb46-253" aria-hidden="true" tabindex="-1"></a>tmr <span class="ot">&lt;-</span> <span class="fu">timer</span>(orni, <span class="at">f =</span> <span class="dv">22050</span>, <span class="at">threshold =</span> <span class="dv">5</span>, <span class="at">ssmooth =</span> <span class="dv">40</span>, </span>
<span id="cb46-254"><a href="#cb46-254" aria-hidden="true" tabindex="-1"></a>             <span class="at">bty =</span> <span class="st">"l"</span>, <span class="at">colval =</span> <span class="st">"#51c724"</span>)</span>
<span id="cb46-255"><a href="#cb46-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-256"><a href="#cb46-256" aria-hidden="true" tabindex="-1"></a>tmr</span>
<span id="cb46-257"><a href="#cb46-257" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-258"><a href="#cb46-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-259"><a href="#cb46-259" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb46-260"><a href="#cb46-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-261"><a href="#cb46-261" aria-hidden="true" tabindex="-1"></a>The output is a list with the following elements:</span>
<span id="cb46-262"><a href="#cb46-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-263"><a href="#cb46-263" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**s**: duration of detected signals (in s)</span>
<span id="cb46-264"><a href="#cb46-264" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**p**: duration of pauses (i.e. gaps) between signals</span>
<span id="cb46-265"><a href="#cb46-265" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**r**: ratio of **s** to **r**</span>
<span id="cb46-266"><a href="#cb46-266" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**s.start**: start of signals</span>
<span id="cb46-267"><a href="#cb46-267" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**end**: end of signals</span>
<span id="cb46-268"><a href="#cb46-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-269"><a href="#cb46-269" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb46-270"><a href="#cb46-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-271"><a href="#cb46-271" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-info}</span>
<span id="cb46-272"><a href="#cb46-272" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;font</span> <span class="er">size</span><span class="ot">=</span><span class="st">"5"</span><span class="kw">&gt;</span>Exercise<span class="kw">&lt;/font&gt;</span></span>
<span id="cb46-273"><a href="#cb46-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-274"><a href="#cb46-274" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>In the previous example using <span class="in">`timer()`</span> the last pulse is divided into 2 detections, one very small at the beginning and another containing the rest of the pulse. Change the "ssmooth" argument until this section is detected as a single pulse.</span>
<span id="cb46-275"><a href="#cb46-275" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-276"><a href="#cb46-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-277"><a href="#cb46-277" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb46-278"><a href="#cb46-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-279"><a href="#cb46-279" aria-hidden="true" tabindex="-1"></a><span class="fu">## Power Spectra</span></span>
<span id="cb46-280"><a href="#cb46-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-281"><a href="#cb46-281" aria-hidden="true" tabindex="-1"></a>We can visualize the amplitude in the frequency domain using power spectra. The <span class="in">`meanspec()`</span> function calculates the average distribution of energy in the frequency range (the average power spectrum):</span>
<span id="cb46-282"><a href="#cb46-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-283"><a href="#cb46-283" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = TRUE, echo = TRUE}</span></span>
<span id="cb46-284"><a href="#cb46-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-285"><a href="#cb46-285" aria-hidden="true" tabindex="-1"></a>mspc <span class="ot">&lt;-</span> <span class="fu">meanspec</span>(orni, <span class="at">f =</span> <span class="dv">22050</span>, <span class="at">wl =</span> <span class="dv">512</span>, <span class="at">col =</span> <span class="st">"#daeace"</span>)</span>
<span id="cb46-286"><a href="#cb46-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-287"><a href="#cb46-287" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), mspc), <span class="at">col =</span> <span class="st">"#daeace"</span>)</span>
<span id="cb46-288"><a href="#cb46-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-289"><a href="#cb46-289" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(mspc)</span>
<span id="cb46-290"><a href="#cb46-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-291"><a href="#cb46-291" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-292"><a href="#cb46-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-293"><a href="#cb46-293" aria-hidden="true" tabindex="-1"></a>The <span class="in">`spec()`</span> function, on the other hand, calculates the spectrum for the entire signal:</span>
<span id="cb46-294"><a href="#cb46-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-295"><a href="#cb46-295" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = TRUE, echo = TRUE}</span></span>
<span id="cb46-296"><a href="#cb46-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-297"><a href="#cb46-297" aria-hidden="true" tabindex="-1"></a>spc <span class="ot">&lt;-</span> <span class="fu">spec</span>(orni, <span class="at">f=</span><span class="dv">22050</span>, <span class="at">wl=</span><span class="dv">512</span>, <span class="at">col =</span> <span class="st">"#8fcc78"</span>)</span>
<span id="cb46-298"><a href="#cb46-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-299"><a href="#cb46-299" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(spc)</span>
<span id="cb46-300"><a href="#cb46-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-301"><a href="#cb46-301" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-302"><a href="#cb46-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-303"><a href="#cb46-303" aria-hidden="true" tabindex="-1"></a>The result of <span class="in">`spec()`</span> or <span class="in">`meanspec()`</span> can be input into the <span class="in">`fpeaks()`</span> function to calculate amplitude peaks:</span>
<span id="cb46-304"><a href="#cb46-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-305"><a href="#cb46-305" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = TRUE, echo = TRUE, warning = FALSE}</span></span>
<span id="cb46-306"><a href="#cb46-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-307"><a href="#cb46-307" aria-hidden="true" tabindex="-1"></a>pks <span class="ot">&lt;-</span> <span class="fu">fpeaks</span>(spc, <span class="at">nmax =</span> <span class="dv">1</span>)</span>
<span id="cb46-308"><a href="#cb46-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-309"><a href="#cb46-309" aria-hidden="true" tabindex="-1"></a>pks</span>
<span id="cb46-310"><a href="#cb46-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-311"><a href="#cb46-311" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-312"><a href="#cb46-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-313"><a href="#cb46-313" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb46-314"><a href="#cb46-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-315"><a href="#cb46-315" aria-hidden="true" tabindex="-1"></a><span class="fu">## Wave manipulation</span></span>
<span id="cb46-316"><a href="#cb46-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-317"><a href="#cb46-317" aria-hidden="true" tabindex="-1"></a>We can cut segments of a "wave" object:</span>
<span id="cb46-318"><a href="#cb46-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-319"><a href="#cb46-319" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = TRUE, echo = TRUE, warning = FALSE}</span></span>
<span id="cb46-320"><a href="#cb46-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-321"><a href="#cb46-321" aria-hidden="true" tabindex="-1"></a>tico2 <span class="ot">&lt;-</span> <span class="fu">cutw</span>(tico, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">output =</span> <span class="st">"Wave"</span>)</span>
<span id="cb46-322"><a href="#cb46-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-323"><a href="#cb46-323" aria-hidden="true" tabindex="-1"></a><span class="fu">oscillo</span>(tico2)</span>
<span id="cb46-324"><a href="#cb46-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-325"><a href="#cb46-325" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-326"><a href="#cb46-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-327"><a href="#cb46-327" aria-hidden="true" tabindex="-1"></a>Add segments:</span>
<span id="cb46-328"><a href="#cb46-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-329"><a href="#cb46-329" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = TRUE, echo = TRUE, warning = FALSE}</span></span>
<span id="cb46-330"><a href="#cb46-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-331"><a href="#cb46-331" aria-hidden="true" tabindex="-1"></a>tico3 <span class="ot">&lt;-</span> <span class="fu">pastew</span>(tico, tico2, <span class="at">output =</span> <span class="st">"Wave"</span>)</span>
<span id="cb46-332"><a href="#cb46-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-333"><a href="#cb46-333" aria-hidden="true" tabindex="-1"></a><span class="fu">oscillo</span>(tico3)</span>
<span id="cb46-334"><a href="#cb46-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-335"><a href="#cb46-335" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-336"><a href="#cb46-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-337"><a href="#cb46-337" aria-hidden="true" tabindex="-1"></a>Remove segments:</span>
<span id="cb46-338"><a href="#cb46-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-339"><a href="#cb46-339" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = TRUE, echo = TRUE, warning = FALSE}</span></span>
<span id="cb46-340"><a href="#cb46-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-341"><a href="#cb46-341" aria-hidden="true" tabindex="-1"></a>tico4 <span class="ot">&lt;-</span> <span class="fu">deletew</span>(tico3, <span class="at">output =</span> <span class="st">"Wave"</span>, <span class="at">from =</span> <span class="fu">duration</span>(tico), <span class="at">to =</span> <span class="fu">duration</span>(tico3))</span>
<span id="cb46-342"><a href="#cb46-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-343"><a href="#cb46-343" aria-hidden="true" tabindex="-1"></a><span class="fu">oscillo</span>(tico4)</span>
<span id="cb46-344"><a href="#cb46-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-345"><a href="#cb46-345" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-346"><a href="#cb46-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-347"><a href="#cb46-347" aria-hidden="true" tabindex="-1"></a>Add segments of silence:</span>
<span id="cb46-348"><a href="#cb46-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-349"><a href="#cb46-349" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = TRUE, echo = TRUE, warning = FALSE}</span></span>
<span id="cb46-350"><a href="#cb46-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-351"><a href="#cb46-351" aria-hidden="true" tabindex="-1"></a>tico5 <span class="ot">&lt;-</span> <span class="fu">addsilw</span>(tico, <span class="at">at =</span> <span class="st">"end"</span>, <span class="at">d =</span> <span class="dv">1</span>, <span class="at">output =</span> <span class="st">"Wave"</span>)</span>
<span id="cb46-352"><a href="#cb46-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-353"><a href="#cb46-353" aria-hidden="true" tabindex="-1"></a><span class="fu">duration</span>(tico)</span>
<span id="cb46-354"><a href="#cb46-354" aria-hidden="true" tabindex="-1"></a><span class="fu">duration</span>(tico5)</span>
<span id="cb46-355"><a href="#cb46-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-356"><a href="#cb46-356" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-357"><a href="#cb46-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-358"><a href="#cb46-358" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb46-359"><a href="#cb46-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-360"><a href="#cb46-360" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-info}</span>
<span id="cb46-361"><a href="#cb46-361" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;font</span> <span class="er">size</span><span class="ot">=</span><span class="st">"5"</span><span class="kw">&gt;</span>Exercise<span class="kw">&lt;/font&gt;</span></span>
<span id="cb46-362"><a href="#cb46-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-363"><a href="#cb46-363" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The function <span class="in">`rev()`</span> can reverse te order of a vector:</span>
<span id="cb46-364"><a href="#cb46-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-367"><a href="#cb46-367" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-368"><a href="#cb46-368" aria-hidden="true" tabindex="-1"></a>v1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb46-369"><a href="#cb46-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-370"><a href="#cb46-370" aria-hidden="true" tabindex="-1"></a><span class="fu">rev</span>(v1)</span>
<span id="cb46-371"><a href="#cb46-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-372"><a href="#cb46-372" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-373"><a href="#cb46-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-374"><a href="#cb46-374" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Reverse the amplitude vector of 'tico' and generate a spectrogram of the reversed wave object</span>
<span id="cb46-375"><a href="#cb46-375" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-376"><a href="#cb46-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-377"><a href="#cb46-377" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb46-378"><a href="#cb46-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-379"><a href="#cb46-379" aria-hidden="true" tabindex="-1"></a>Filter out frequency bands:</span>
<span id="cb46-380"><a href="#cb46-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-381"><a href="#cb46-381" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = TRUE, echo = TRUE, warning = FALSE}</span></span>
<span id="cb46-382"><a href="#cb46-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-383"><a href="#cb46-383" aria-hidden="true" tabindex="-1"></a><span class="co"># original</span></span>
<span id="cb46-384"><a href="#cb46-384" aria-hidden="true" tabindex="-1"></a><span class="fu">spectro</span>(tico, <span class="at">scale =</span> <span class="cn">FALSE</span>, <span class="at">grid =</span> <span class="cn">FALSE</span>, <span class="at">flim =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">6</span>))</span>
<span id="cb46-385"><a href="#cb46-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-386"><a href="#cb46-386" aria-hidden="true" tabindex="-1"></a><span class="co"># filtered</span></span>
<span id="cb46-387"><a href="#cb46-387" aria-hidden="true" tabindex="-1"></a><span class="fu">spectro</span>(<span class="fu">ffilter</span>(tico, <span class="at">from =</span> <span class="dv">4000</span>, <span class="at">to =</span> <span class="dv">6500</span>, <span class="at">output =</span> <span class="st">"Wave"</span>), <span class="at">scale =</span> <span class="cn">FALSE</span>, <span class="at">grid =</span> <span class="cn">FALSE</span>, <span class="at">flim =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">6</span>))</span>
<span id="cb46-388"><a href="#cb46-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-389"><a href="#cb46-389" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-390"><a href="#cb46-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-391"><a href="#cb46-391" aria-hidden="true" tabindex="-1"></a>Change frequency (pitch):</span>
<span id="cb46-392"><a href="#cb46-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-393"><a href="#cb46-393" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = TRUE, echo = TRUE, warning = FALSE}</span></span>
<span id="cb46-394"><a href="#cb46-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-395"><a href="#cb46-395" aria-hidden="true" tabindex="-1"></a><span class="co"># cut the first</span></span>
<span id="cb46-396"><a href="#cb46-396" aria-hidden="true" tabindex="-1"></a>tico6 <span class="ot">&lt;-</span> <span class="fu">cutw</span>(tico, <span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="fl">0.5</span>, <span class="at">output =</span> <span class="st">"Wave"</span>)</span>
<span id="cb46-397"><a href="#cb46-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-398"><a href="#cb46-398" aria-hidden="true" tabindex="-1"></a><span class="co"># increase frec</span></span>
<span id="cb46-399"><a href="#cb46-399" aria-hidden="true" tabindex="-1"></a>tico.lfs <span class="ot">&lt;-</span> <span class="fu">lfs</span>(tico6, <span class="at">shift =</span> <span class="dv">1000</span>, <span class="at">output =</span> <span class="st">"Wave"</span>)</span>
<span id="cb46-400"><a href="#cb46-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-401"><a href="#cb46-401" aria-hidden="true" tabindex="-1"></a><span class="co"># decrease frec</span></span>
<span id="cb46-402"><a href="#cb46-402" aria-hidden="true" tabindex="-1"></a>tico.lfs.neg <span class="ot">&lt;-</span> <span class="fu">lfs</span>(tico6, <span class="at">shift =</span> <span class="sc">-</span><span class="dv">1000</span>, <span class="at">output =</span> <span class="st">"Wave"</span>)</span>
<span id="cb46-403"><a href="#cb46-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-404"><a href="#cb46-404" aria-hidden="true" tabindex="-1"></a><span class="co"># 3 column graph</span></span>
<span id="cb46-405"><a href="#cb46-405" aria-hidden="true" tabindex="-1"></a>opar <span class="ot">&lt;-</span> <span class="fu">par</span>()</span>
<span id="cb46-406"><a href="#cb46-406" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb46-407"><a href="#cb46-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-408"><a href="#cb46-408" aria-hidden="true" tabindex="-1"></a><span class="co"># original</span></span>
<span id="cb46-409"><a href="#cb46-409" aria-hidden="true" tabindex="-1"></a><span class="fu">spectro</span>(tico6, <span class="at">scale =</span> <span class="cn">FALSE</span>, <span class="at">grid =</span> <span class="cn">FALSE</span>, <span class="at">flim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">8</span>), <span class="at">main =</span> <span class="st">"original"</span>)</span>
<span id="cb46-410"><a href="#cb46-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-411"><a href="#cb46-411" aria-hidden="true" tabindex="-1"></a><span class="co"># modified</span></span>
<span id="cb46-412"><a href="#cb46-412" aria-hidden="true" tabindex="-1"></a><span class="fu">spectro</span>(tico.lfs, <span class="at">scale =</span> <span class="cn">FALSE</span>, <span class="at">grid =</span> <span class="cn">FALSE</span>, <span class="at">flim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">8</span>), <span class="at">main =</span> <span class="st">"1 kHz up"</span>)</span>
<span id="cb46-413"><a href="#cb46-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-414"><a href="#cb46-414" aria-hidden="true" tabindex="-1"></a><span class="fu">spectro</span>(tico.lfs.neg, <span class="at">scale =</span> <span class="cn">FALSE</span>, <span class="at">grid =</span> <span class="cn">FALSE</span>, <span class="at">flim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">8</span>), <span class="at">main =</span> <span class="st">"1 kHz down"</span>)</span>
<span id="cb46-415"><a href="#cb46-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-416"><a href="#cb46-416" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(opar)</span>
<span id="cb46-417"><a href="#cb46-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-418"><a href="#cb46-418" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-419"><a href="#cb46-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-420"><a href="#cb46-420" aria-hidden="true" tabindex="-1"></a><span class="fu">## Measurements</span></span>
<span id="cb46-421"><a href="#cb46-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-422"><a href="#cb46-422" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb46-423"><a href="#cb46-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-424"><a href="#cb46-424" aria-hidden="true" tabindex="-1"></a>Apart from the measurements of peak frequency (<span class="in">`fpeaks()`</span>) and duration (<span class="in">`timer()`</span>), we can measure many other aspects of the acoustic signals using **seewave**. For example, we can estimate the fundamental frequency (which refers to the lowest frequency harmonic in the harmonic stack), with the <span class="in">`fund()`</span> function:</span>
<span id="cb46-425"><a href="#cb46-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-426"><a href="#cb46-426" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = TRUE, echo = TRUE, warning = FALSE}</span></span>
<span id="cb46-427"><a href="#cb46-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-428"><a href="#cb46-428" aria-hidden="true" tabindex="-1"></a><span class="fu">spectro</span>(sheep, <span class="at">scale =</span> <span class="cn">FALSE</span>, <span class="at">grid =</span> <span class="cn">FALSE</span>)</span>
<span id="cb46-429"><a href="#cb46-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-430"><a href="#cb46-430" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span><span class="cn">TRUE</span>)</span>
<span id="cb46-431"><a href="#cb46-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-432"><a href="#cb46-432" aria-hidden="true" tabindex="-1"></a>ff <span class="ot">&lt;-</span> <span class="fu">fund</span>(sheep, <span class="at">fmax =</span> <span class="dv">300</span>, <span class="at">ann =</span> <span class="cn">FALSE</span>, <span class="at">threshold=</span><span class="dv">6</span>, <span class="at">col =</span> <span class="st">"green"</span>)</span>
<span id="cb46-433"><a href="#cb46-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-434"><a href="#cb46-434" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ff)</span>
<span id="cb46-435"><a href="#cb46-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-436"><a href="#cb46-436" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-437"><a href="#cb46-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-438"><a href="#cb46-438" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb46-439"><a href="#cb46-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-440"><a href="#cb46-440" aria-hidden="true" tabindex="-1"></a>This function uses cepstral transformation to detect the dominant frequency. The <span class="in">`autoc()`</span> function also measures the fundamental frequency, only using autocorrelation.</span>
<span id="cb46-441"><a href="#cb46-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-442"><a href="#cb46-442" aria-hidden="true" tabindex="-1"></a>Similarly we can measure the dominant frequency (the harmonic with the highest energy):</span>
<span id="cb46-443"><a href="#cb46-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-444"><a href="#cb46-444" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = FALSE, echo = TRUE, warning = FALSE}</span></span>
<span id="cb46-445"><a href="#cb46-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-446"><a href="#cb46-446" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span><span class="cn">TRUE</span>)</span>
<span id="cb46-447"><a href="#cb46-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-448"><a href="#cb46-448" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">dfreq</span>(sheep, <span class="at">f =</span> <span class="dv">8000</span>, <span class="at">fmax =</span> <span class="dv">300</span>, <span class="at">type =</span> <span class="st">"p"</span>, <span class="at">pch =</span> <span class="dv">24</span>, <span class="at">ann =</span> <span class="cn">FALSE</span>, <span class="at">threshold =</span> <span class="dv">6</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb46-449"><a href="#cb46-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-450"><a href="#cb46-450" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span>
<span id="cb46-451"><a href="#cb46-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-452"><a href="#cb46-452" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-453"><a href="#cb46-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-454"><a href="#cb46-454" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = TRUE, echo = FALSE, warning = FALSE}</span></span>
<span id="cb46-455"><a href="#cb46-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-456"><a href="#cb46-456" aria-hidden="true" tabindex="-1"></a><span class="fu">spectro</span>(sheep, <span class="at">scale =</span> <span class="cn">FALSE</span>)</span>
<span id="cb46-457"><a href="#cb46-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-458"><a href="#cb46-458" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span><span class="cn">TRUE</span>)</span>
<span id="cb46-459"><a href="#cb46-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-460"><a href="#cb46-460" aria-hidden="true" tabindex="-1"></a>ff <span class="ot">&lt;-</span> <span class="fu">fund</span>(sheep, <span class="at">fmax =</span> <span class="dv">300</span>, <span class="at">ann =</span> <span class="cn">FALSE</span>, <span class="at">threshold=</span><span class="dv">6</span>, <span class="at">col =</span> <span class="st">"green"</span>)</span>
<span id="cb46-461"><a href="#cb46-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-462"><a href="#cb46-462" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span><span class="cn">TRUE</span>)</span>
<span id="cb46-463"><a href="#cb46-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-464"><a href="#cb46-464" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">dfreq</span>(sheep, <span class="at">fmax =</span> <span class="dv">300</span>, <span class="at">type =</span> <span class="st">"p"</span>, <span class="at">pch =</span> <span class="dv">24</span>, <span class="at">ann =</span> <span class="cn">FALSE</span>, <span class="at">threshold =</span> <span class="dv">6</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb46-465"><a href="#cb46-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-466"><a href="#cb46-466" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span>
<span id="cb46-467"><a href="#cb46-467" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-468"><a href="#cb46-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-469"><a href="#cb46-469" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb46-470"><a href="#cb46-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-471"><a href="#cb46-471" aria-hidden="true" tabindex="-1"></a>Measure statistical descriptors of the amplitude distribution in frequency and time:</span>
<span id="cb46-472"><a href="#cb46-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-473"><a href="#cb46-473" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = TRUE, echo = TRUE, warning = FALSE}</span></span>
<span id="cb46-474"><a href="#cb46-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-475"><a href="#cb46-475" aria-hidden="true" tabindex="-1"></a><span class="co"># cut</span></span>
<span id="cb46-476"><a href="#cb46-476" aria-hidden="true" tabindex="-1"></a>note2 <span class="ot">&lt;-</span> <span class="fu">cutw</span>(tico, <span class="at">from=</span><span class="fl">0.6</span>, <span class="at">to=</span><span class="fl">0.9</span>, <span class="at">output=</span><span class="st">"Wave"</span>)</span>
<span id="cb46-477"><a href="#cb46-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-478"><a href="#cb46-478" aria-hidden="true" tabindex="-1"></a>n2.as <span class="ot">&lt;-</span> <span class="fu">acoustat</span>(note2)</span>
<span id="cb46-479"><a href="#cb46-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-480"><a href="#cb46-480" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(n2.as[<span class="dv">3</span><span class="sc">:</span><span class="dv">8</span>])</span>
<span id="cb46-481"><a href="#cb46-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-482"><a href="#cb46-482" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-483"><a href="#cb46-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-484"><a href="#cb46-484" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb46-485"><a href="#cb46-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-486"><a href="#cb46-486" aria-hidden="true" tabindex="-1"></a>Measure statistical descriptors of frequency spectra:</span>
<span id="cb46-487"><a href="#cb46-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-488"><a href="#cb46-488" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval = TRUE, echo = TRUE, warning = FALSE}</span></span>
<span id="cb46-489"><a href="#cb46-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-490"><a href="#cb46-490" aria-hidden="true" tabindex="-1"></a><span class="co"># measure power spectrum</span></span>
<span id="cb46-491"><a href="#cb46-491" aria-hidden="true" tabindex="-1"></a>n2.sp <span class="ot">&lt;-</span> <span class="fu">meanspec</span>(note2, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb46-492"><a href="#cb46-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-493"><a href="#cb46-493" aria-hidden="true" tabindex="-1"></a>n2.spcp <span class="ot">&lt;-</span> <span class="fu">specprop</span>(n2.sp, <span class="at">f =</span> note2<span class="sc">@</span>samp.rate)</span>
<span id="cb46-494"><a href="#cb46-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-495"><a href="#cb46-495" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.frame</span>(n2.spcp)</span>
<span id="cb46-496"><a href="#cb46-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-497"><a href="#cb46-497" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-498"><a href="#cb46-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-499"><a href="#cb46-499" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb46-500"><a href="#cb46-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-501"><a href="#cb46-501" aria-hidden="true" tabindex="-1"></a>::: {.alert .alert-info}</span>
<span id="cb46-502"><a href="#cb46-502" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;font</span> <span class="er">size</span><span class="ot">=</span><span class="st">"5"</span><span class="kw">&gt;</span>Exercise<span class="kw">&lt;/font&gt;</span></span>
<span id="cb46-503"><a href="#cb46-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-504"><a href="#cb46-504" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Measure the statistical descriptors of the frequency spectra (function <span class="in">`specprop()`</span>) on the 3 notes (hint: you must cut each note first)</span>
<span id="cb46-505"><a href="#cb46-505" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-506"><a href="#cb46-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-507"><a href="#cb46-507" aria-hidden="true" tabindex="-1"></a>&nbsp;</span>
<span id="cb46-508"><a href="#cb46-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-509"><a href="#cb46-509" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb46-510"><a href="#cb46-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-511"><a href="#cb46-511" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;font</span> <span class="er">size</span><span class="ot">=</span><span class="st">"4"</span><span class="kw">&gt;</span>Session information<span class="kw">&lt;/font&gt;</span></span>
<span id="cb46-512"><a href="#cb46-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-513"><a href="#cb46-513" aria-hidden="true" tabindex="-1"></a><span class="in">```{r session info, echo=F}</span></span>
<span id="cb46-514"><a href="#cb46-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-515"><a href="#cb46-515" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb46-516"><a href="#cb46-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-517"><a href="#cb46-517" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">Copyright 2023 | <a href="https://marce10.github.io">Marcelo Araya-Salas</a></div>
  </div>
</footer>



</body></html>